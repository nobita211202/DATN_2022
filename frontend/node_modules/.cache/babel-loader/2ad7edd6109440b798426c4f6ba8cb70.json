{"remainingRequest":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\src\\state\\modules\\auth.js","dependencies":[{"path":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\src\\state\\modules\\auth.js","mtime":1670294674471},{"path":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\babel.config.js","mtime":1670294673677},{"path":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670297177879},{"path":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1670297177813},{"path":"C:\\Users\\tho.lv\\Desktop\\Oauth0\\DATN_2022\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1670297184228}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IHZhciBzdGF0ZSA9IHsKICBjdXJyZW50VXNlcjogZ2V0U2F2ZWRTdGF0ZSgnYXV0aC5jdXJyZW50VXNlcicpCn07CmV4cG9ydCB2YXIgbXV0YXRpb25zID0gewogIFNFVF9DVVJSRU5UX1VTRVI6IGZ1bmN0aW9uIFNFVF9DVVJSRU5UX1VTRVIoc3RhdGUsIG5ld1ZhbHVlKSB7CiAgICBzdGF0ZS5jdXJyZW50VXNlciA9IG5ld1ZhbHVlOwogICAgc2F2ZVN0YXRlKCdhdXRoLmN1cnJlbnRVc2VyJywgbmV3VmFsdWUpOwogICAgc2V0RGVmYXVsdEF1dGhIZWFkZXJzKHN0YXRlKTsKICB9Cn07CmV4cG9ydCB2YXIgZ2V0dGVycyA9IHsKICAvLyBXaGV0aGVyIHRoZSB1c2VyIGlzIGN1cnJlbnRseSBsb2dnZWQgaW4uCiAgbG9nZ2VkSW46IGZ1bmN0aW9uIGxvZ2dlZEluKHN0YXRlKSB7CiAgICByZXR1cm4gISFzdGF0ZS5jdXJyZW50VXNlcjsKICB9Cn07CmV4cG9ydCB2YXIgYWN0aW9ucyA9IHsKICAvLyBUaGlzIGlzIGF1dG9tYXRpY2FsbHkgcnVuIGluIGBzcmMvc3RhdGUvc3RvcmUuanNgIHdoZW4gdGhlIGFwcAogIC8vIHN0YXJ0cywgYWxvbmcgd2l0aCBhbnkgb3RoZXIgYWN0aW9ucyBuYW1lZCBgaW5pdGAgaW4gb3RoZXIgbW9kdWxlcy4KICBpbml0OiBmdW5jdGlvbiBpbml0KF9yZWYpIHsKICAgIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsCiAgICAgIGRpc3BhdGNoID0gX3JlZi5kaXNwYXRjaDsKICAgIHNldERlZmF1bHRBdXRoSGVhZGVycyhzdGF0ZSk7CiAgICBkaXNwYXRjaCgndmFsaWRhdGUnKTsKICB9LAogIC8vIExvZ3MgaW4gdGhlIGN1cnJlbnQgdXNlci4KICBsb2dJbjogZnVuY3Rpb24gbG9nSW4oX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgIGRpc3BhdGNoID0gX3JlZjIuZGlzcGF0Y2gsCiAgICAgIGdldHRlcnMgPSBfcmVmMi5nZXR0ZXJzOwogICAgdmFyIF9yZWYzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fSwKICAgICAgdXNlcm5hbWUgPSBfcmVmMy51c2VybmFtZSwKICAgICAgcGFzc3dvcmQgPSBfcmVmMy5wYXNzd29yZDsKICAgIGlmIChnZXR0ZXJzLmxvZ2dlZEluKSByZXR1cm4gZGlzcGF0Y2goJ3ZhbGlkYXRlJyk7CiAgICByZXR1cm4gYXhpb3MucG9zdCgnL2FwaS9zZXNzaW9uJywgewogICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgdmFyIHVzZXIgPSByZXNwb25zZS5kYXRhOwogICAgICBjb21taXQoJ1NFVF9DVVJSRU5UX1VTRVInLCB1c2VyKTsKICAgICAgcmV0dXJuIHVzZXI7CiAgICB9KTsKICB9LAogIC8vIExvZ3Mgb3V0IHRoZSBjdXJyZW50IHVzZXIuCiAgbG9nT3V0OiBmdW5jdGlvbiBsb2dPdXQoX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICBjb21taXQoJ1NFVF9DVVJSRU5UX1VTRVInLCBudWxsKTsKICB9LAogIC8vIFZhbGlkYXRlcyB0aGUgY3VycmVudCB1c2VyJ3MgdG9rZW4gYW5kIHJlZnJlc2hlcyBpdAogIC8vIHdpdGggbmV3IGRhdGEgZnJvbSB0aGUgQVBJLgogIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZShfcmVmNSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY1LmNvbW1pdCwKICAgICAgc3RhdGUgPSBfcmVmNS5zdGF0ZTsKICAgIGlmICghc3RhdGUuY3VycmVudFVzZXIpIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7CiAgICByZXR1cm4gYXhpb3MuZ2V0KCcvYXBpL3Nlc3Npb24nKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICB2YXIgdXNlciA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIGNvbW1pdCgnU0VUX0NVUlJFTlRfVVNFUicsIHVzZXIpOwogICAgICByZXR1cm4gdXNlcjsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICBpZiAoZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICBjb21taXQoJ1NFVF9DVVJSRU5UX1VTRVInLCBudWxsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oZXJyb3IpOwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfSk7CiAgfQp9OwoKLy8gPT09Ci8vIFByaXZhdGUgaGVscGVycwovLyA9PT0KCmZ1bmN0aW9uIGdldFNhdmVkU3RhdGUoa2V5KSB7CiAgcmV0dXJuIEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpOwp9CmZ1bmN0aW9uIHNhdmVTdGF0ZShrZXksIHN0YXRlKSB7CiAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTsKfQpmdW5jdGlvbiBzZXREZWZhdWx0QXV0aEhlYWRlcnMoc3RhdGUpIHsKICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5BdXRob3JpemF0aW9uID0gc3RhdGUuY3VycmVudFVzZXIgPyBzdGF0ZS5jdXJyZW50VXNlci50b2tlbiA6ICcnOwp9"},{"version":3,"names":["axios","state","currentUser","getSavedState","mutations","SET_CURRENT_USER","newValue","saveState","setDefaultAuthHeaders","getters","loggedIn","actions","init","dispatch","logIn","commit","username","password","post","then","response","user","data","logOut","validate","Promise","resolve","get","catch","error","status","console","warn","key","JSON","parse","window","localStorage","getItem","setItem","stringify","defaults","headers","common","Authorization","token"],"sources":["C:/Users/tho.lv/Desktop/Oauth0/DATN_2022/frontend/src/state/modules/auth.js"],"sourcesContent":["import axios from 'axios'\r\n\r\nexport const state = {\r\n  currentUser: getSavedState('auth.currentUser'),\r\n}\r\n\r\nexport const mutations = {\r\n  SET_CURRENT_USER(state, newValue) {\r\n    state.currentUser = newValue\r\n    saveState('auth.currentUser', newValue)\r\n    setDefaultAuthHeaders(state)\r\n  },\r\n}\r\n\r\nexport const getters = {\r\n  // Whether the user is currently logged in.\r\n  loggedIn(state) {\r\n    return !!state.currentUser\r\n  },\r\n}\r\n\r\nexport const actions = {\r\n  // This is automatically run in `src/state/store.js` when the app\r\n  // starts, along with any other actions named `init` in other modules.\r\n  init({ state, dispatch }) {\r\n    setDefaultAuthHeaders(state)\r\n    dispatch('validate')\r\n  },\r\n\r\n  // Logs in the current user.\r\n  logIn({ commit, dispatch, getters }, { username, password } = {}) {\r\n    if (getters.loggedIn) return dispatch('validate')\r\n\r\n    return axios\r\n      .post('/api/session', { username, password })\r\n      .then((response) => {\r\n        const user = response.data\r\n        commit('SET_CURRENT_USER', user)\r\n        return user\r\n      })\r\n  },\r\n\r\n  // Logs out the current user.\r\n  logOut({ commit }) {\r\n    commit('SET_CURRENT_USER', null)\r\n  },\r\n\r\n  // Validates the current user's token and refreshes it\r\n  // with new data from the API.\r\n  validate({ commit, state }) {\r\n    if (!state.currentUser) return Promise.resolve(null)\r\n\r\n    return axios\r\n      .get('/api/session')\r\n      .then((response) => {\r\n        const user = response.data\r\n        commit('SET_CURRENT_USER', user)\r\n        return user\r\n      })\r\n      .catch((error) => {\r\n        if (error.response && error.response.status === 401) {\r\n          commit('SET_CURRENT_USER', null)\r\n        } else {\r\n          console.warn(error)\r\n        }\r\n        return null\r\n      })\r\n  },\r\n}\r\n\r\n// ===\r\n// Private helpers\r\n// ===\r\n\r\nfunction getSavedState(key) {\r\n  return JSON.parse(window.localStorage.getItem(key))\r\n}\r\n\r\nfunction saveState(key, state) {\r\n  window.localStorage.setItem(key, JSON.stringify(state))\r\n}\r\n\r\nfunction setDefaultAuthHeaders(state) {\r\n  axios.defaults.headers.common.Authorization = state.currentUser\r\n    ? state.currentUser.token\r\n    : ''\r\n}\r\n"],"mappings":"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"}]}